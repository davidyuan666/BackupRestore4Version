{
  "version": "1.2",
  "description": "Table restructuring - merged patient contact info into separate table",
  "tables": {
    "patients": {
      "fields": {
        "patient_id": {"type": "INT", "primary_key": true, "nullable": false},
        "name": {"type": "VARCHAR(100)", "nullable": false},
        "birth_date": {"type": "DATE", "nullable": false},
        "gender": {"type": "VARCHAR(10)", "nullable": false},
        "address": {"type": "VARCHAR(255)", "nullable": true}
      },
      "indexes": ["patient_id"]
    },
    "patient_contacts": {
      "fields": {
        "contact_id": {"type": "INT", "primary_key": true, "nullable": false},
        "patient_id": {"type": "INT", "nullable": false},
        "phone": {"type": "VARCHAR(20)", "nullable": true},
        "email": {"type": "VARCHAR(100)", "nullable": true},
        "emergency_contact": {"type": "VARCHAR(100)", "nullable": true},
        "emergency_phone": {"type": "VARCHAR(20)", "nullable": true}
      },
      "foreign_keys": {
        "patient_id": {"references": "patients.patient_id", "on_delete": "CASCADE"}
      },
      "indexes": ["contact_id", "patient_id"]
    },
    "studies": {
      "fields": {
        "study_id": {"type": "INT", "primary_key": true, "nullable": false},
        "patient_id": {"type": "INT", "nullable": false},
        "study_date": {"type": "DATETIME", "nullable": false},
        "modality": {"type": "VARCHAR(10)", "nullable": false},
        "description": {"type": "TEXT", "nullable": true},
        "status": {"type": "VARCHAR(20)", "nullable": false, "default": "pending"}
      },
      "foreign_keys": {
        "patient_id": {"references": "patients.patient_id", "on_delete": "CASCADE"}
      },
      "indexes": ["study_id", "patient_id", "study_date"]
    },
    "images": {
      "fields": {
        "image_id": {"type": "INT", "primary_key": true, "nullable": false},
        "study_id": {"type": "INT", "nullable": false},
        "image_path": {"type": "VARCHAR(255)", "nullable": false},
        "image_size": {"type": "INT", "nullable": false},
        "format": {"type": "VARCHAR(10)", "nullable": false, "default": "DICOM"}
      },
      "foreign_keys": {
        "study_id": {"references": "studies.study_id", "on_delete": "CASCADE"}
      },
      "indexes": ["image_id", "study_id"]
    },
    "diagnosis": {
      "fields": {
        "diagnosis_id": {"type": "INT", "primary_key": true, "nullable": false},
        "study_id": {"type": "INT", "nullable": false},
        "diagnosis_text": {"type": "TEXT", "nullable": false},
        "diagnosis_code": {"type": "VARCHAR(20)", "nullable": true},
        "created_at": {"type": "DATETIME", "nullable": false},
        "updated_at": {"type": "DATETIME", "nullable": true}
      },
      "foreign_keys": {
        "study_id": {"references": "studies.study_id", "on_delete": "CASCADE"}
      },
      "indexes": ["diagnosis_id", "study_id"]
    }
  }
}
